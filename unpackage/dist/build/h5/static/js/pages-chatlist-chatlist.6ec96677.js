(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-chatlist-chatlist"],{"06c5":function(t,e,i){"use strict";i("a630"),i("fb6a"),i("d3b7"),i("25f0"),i("3ca3"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=o;var n=a(i("6b75"));function a(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(t){if("string"===typeof t)return(0,n.default)(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?(0,n.default)(t,e):void 0}}},"09f0":function(t,e,i){"use strict";function n(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var i=[],n=!0,a=!1,o=void 0;try{for(var s,r=t[Symbol.iterator]();!(n=(s=r.next()).done);n=!0)if(i.push(s.value),e&&i.length===e)break}catch(c){a=!0,o=c}finally{try{n||null==r["return"]||r["return"]()}finally{if(a)throw o}}return i}}i("a4d3"),i("e01a"),i("d28b"),i("d3b7"),i("3ca3"),i("ddb0"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},"0d21":function(t,e,i){"use strict";function n(t){if(Array.isArray(t))return t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},"1dd8":function(t,e,i){var n=i("67ce");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("403dde32",n,!0,{sourceMap:!1,shadowMode:!1})},"1dd9":function(t,e,i){"use strict";i.r(e);var n=i("b3d0"),a=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a},"1de5":function(t,e,i){"use strict";t.exports=function(t,e){return e||(e={}),t=t&&t.__esModule?t.default:t,"string"!==typeof t?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t)}},"201f":function(t,e,i){"use strict";(function(t){var n=i("4ea4");i("d81d"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("a9bd"));function o(t,e,i){this.uuid=t,this.name=e,this.avatar=i}function s(t,e,i){this.uuid=t,this.name=e,this.avatar=i}function r(t,e){this.currentUser=null,this.groups={},this.GoEasy=e,this.goEasy=t,this.privateMessages={},this.groupMessages={},this.onNewPrivateMessageReceive=function(t,e){},this.onNewGroupMessageReceive=function(t,e){}}r.prototype.getGroupMembers=function(t){var e=a.default.findGroupMembers(t),i={};return e.map((function(t){i[t.uuid]=t})),i},r.prototype.findGroupById=function(t){var e=a.default.findGroupById(t);return new s(e.uuid,e.name,e.avatar)},r.prototype.findFriendById=function(e){t("log","t1"," at lib/imservice.js:62");var i=a.default.findUserById(e);return t("log","t1"+i.uuid,i.name,i.avatar," at lib/imservice.js:64"),new o(i.uuid,i.name,i.avatar)},r.prototype.getGroupMessages=function(t){return this.groupMessages[t]||(this.groupMessages[t]=[]),this.groupMessages[t]},r.prototype.getPrivateMessages=function(t){return this.privateMessages[t]||(this.privateMessages[t]=[]),this.privateMessages[t]},r.prototype.connect=function(e){this.currentUser=e;var i={name:this.currentUser.name,avatar:this.currentUser.avatar};this.initialListeners(),this.goEasy.connect({id:this.currentUser.uuid,data:i,onSuccess:function(){t("log","GoEasy connect successfully."," at lib/imservice.js:96")},onFailed:function(e){t("log","Failed to connect GoEasy, code:"+e.code+",error:"+e.content," at lib/imservice.js:100")},onProgress:function(e){t("log","GoEasy is connecting",e," at lib/imservice.js:103")}}),this.subscribeGroupMessage(e)},r.prototype.subscribeGroupMessage=function(){var e=a.default.findGroups(this.currentUser),i=e.map((function(t){return t.uuid}));this.goEasy.im.subscribeGroup({groupIds:i,onSuccess:function(){t("log","订阅群消息成功"," at lib/imservice.js:116")},onFailed:function(e){t("log","订阅群消息失败"," at lib/imservice.js:120")}})},r.prototype.initialListeners=function(){var t=this;this.goEasy.im.on(this.GoEasy.IM_EVENT.PRIVATE_MESSAGE_RECEIVED,(function(e){var i;i=t.currentUser.uuid===e.senderId?e.receiverId:e.senderId;var n=t.getPrivateMessages(i);n.push(e),t.onNewPrivateMessageReceive(i,e)})),this.goEasy.im.on(this.GoEasy.IM_EVENT.GROUP_MESSAGE_RECEIVED,(function(e){var i=e.groupId,n=t.getGroupMessages(i);n.push(e),t.onNewGroupMessageReceive(i,e)}))};var c=r;e.default=c}).call(this,i("0de9")["log"])},3835:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=c;var n=r(i("0d21")),a=r(i("09f0")),o=r(i("06c5")),s=r(i("3d8c"));function r(t){return t&&t.__esModule?t:{default:t}}function c(t,e){return(0,n.default)(t)||(0,a.default)(t,e)||(0,o.default)(t,e)||(0,s.default)()}},"3d8c":function(t,e,i){"use strict";function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},"67ce":function(t,e,i){var n=i("24fb"),a=i("1de5"),o=i("8c02");e=n(!1);var s=a(o);e.push([t.i,"uni-page-body[data-v-76c381c5]{height:100%}.conversations[data-v-76c381c5]{width:%?750?%;overflow-x:hidden;display:flex;flex-direction:column;box-sizing:border-box;height:100%}.conversations .scroll-item[data-v-76c381c5]{height:%?152?%;display:flex;align-items:center;padding-left:%?32?%}.conversations .scroll-item .head-icon[data-v-76c381c5]{width:%?100?%;height:%?100?%;margin-right:%?28?%}.conversations .scroll-item_info[data-v-76c381c5]{height:%?151?%;width:%?590?%;padding-right:%?32?%;box-sizing:border-box;border-bottom:1px solid #efefef}.conversations .scroll-item_info .item-info-top[data-v-76c381c5]{padding-top:%?20?%;height:%?60?%;line-height:%?60?%;display:flex;align-items:center;justify-content:space-between}.conversations .item-info-top_name[data-v-76c381c5]{font-size:%?34?%;color:#262628}.conversations .item-info-top_time[data-v-76c381c5]{font-size:%?26?%;color:hsla(0,0%,70.2%,.8);font-family:Source Han Sans CN}.conversations .item-info-bottom[data-v-76c381c5]{height:%?40?%;line-height:%?40?%;overflow:hidden}.conversations .item-info-bottom-item[data-v-76c381c5]{display:flex;justify-content:space-between}.item-info-bottom .item-info-top_content[data-v-76c381c5]{font-size:%?30?%;color:#b3b3b3;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.item-info-bottom .item-info-bottom_action[data-v-76c381c5]{width:%?50?%;height:%?50?%;font-size:%?20?%;background:url("+s+") no-repeat 50%;background-size:%?28?% %?30?%}.no-conversation[data-v-76c381c5]{width:100%;text-align:center;height:%?80?%;line-height:%?80?%;font-size:%?28?%;color:#9d9d9d}.item-head[data-v-76c381c5]{position:relative}.item-head .item-head_unread[data-v-76c381c5]{padding:%?6?%;background-color:#ee593c;color:#fff;font-size:%?24?%;line-height:%?28?%;border-radius:%?24?%;min-width:%?24?%;min-height:%?24?%;text-align:center;position:absolute;top:0;right:%?15?%}.action-container[data-v-76c381c5]{width:100%;height:100%;position:absolute;top:0;left:0;display:flex;justify-content:center;align-items:center}.action-container .layer[data-v-76c381c5]{position:absolute;top:0;left:0;background:rgba(51,51,51,.5);width:100%;height:100%;z-index:99}.action-box[data-v-76c381c5]{width:%?400?%;height:%?240?%;background:#fff;position:relative;z-index:100;border-radius:%?20?%;overflow:hidden}.action-item[data-v-76c381c5]{text-align:center;line-height:%?120?%;font-size:%?34?%;color:#262628;border-bottom:1px solid #efefef}",""]),t.exports=e},"6b75":function(t,e,i){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},"8c02":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABgSURBVHgB7Y6xDYAwDASDvQAjsBmNF2CDsAEDuGEzRsgCtnikBCEqQpucFOlPl8IhdBpmUNXZzDbsxMxRRPYSaxpBImTEm3K4qWmUpZBeF39u5O4LxnEJ9vr8+bd1muMEOUNL5++YjiMAAAAASUVORK5CYII="},"90af":function(t,e,i){"use strict";var n=i("1dd8"),a=i.n(n);a.a},a9bd:function(t,e,i){"use strict";(function(t){var n=i("4ea4");i("4de4"),i("7db0"),i("d81d"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("3835")),o=[{uuid:"08c0a6ec-a42b",name:"Mattie",password:"123",avatar:"/static/images/Avatar-1.png"},{uuid:"3bb179af-bcc5",name:"Wallace",password:"123",avatar:"/static/images/Avatar-2.png"},{uuid:"fdee46b0-4b01-4590-bdba-6586d7617f95",name:"Tracy",password:"123",avatar:"/static/images/Avatar-3.png"},{uuid:"33c3693b-dbb0-4bc9-99c6-fa77b9eb763f",name:"Juanita",password:"123",avatar:"/static/images/Avatar-4.png"}],s=[{uuid:"group-a42b-47b2-bb1e-15e0f5f9a19a",name:"小程序交流群",avatar:"/static/images/wx.png",userList:["08c0a6ec-a42b-47b2-bb1e-15e0f5f9a19a","3bb179af-bcc5-4fe0-9dac-c05688484649","fdee46b0-4b01-4590-bdba-6586d7617f95","33c3693b-dbb0-4bc9-99c6-fa77b9eb763f"]},{uuid:"group-4b01-4590-bdba-6586d7617f95",name:"UniApp交流群",avatar:"/static/images/uniapp.png",userList:["08c0a6ec-a42b-47b2-bb1e-15e0f5f9a19a","fdee46b0-4b01-4590-bdba-6586d7617f95","33c3693b-dbb0-4bc9-99c6-fa77b9eb763f"]},{uuid:"group-dbb0-4bc9-99c6-fa77b9eb763f",name:"GoEasy交流群",avatar:"/static/images/goeasy.jpeg",userList:["08c0a6ec-a42b-47b2-bb1e-15e0f5f9a19a","3bb179af-bcc5-4fe0-9dac-c05688484649"]}];function r(){}r.prototype.findFriends=function(t){var e=o.filter((function(e){return e.uuid!=t.uuid}));return e},r.prototype.findGroups=function(t){var e=s.filter((function(e){return e.userList.find((function(e){return e==t.uuid}))}));return e},r.prototype.findUser=function(t,e){var i=o.find((function(i){return i.name===t&&i.password===e}));return i?{uuid:i.uuid,avatar:i.avatar,name:i.name}:i},r.prototype.findGroupById=function(t){var e=s.find((function(e){return e.uuid==t}));return e},r.prototype.findUserById=function(e){var i=o.find((function(t){return t.uuid==e})),n=uni.request({method:"GET",url:"https://wechat.api.kohaku.xin:11731/user/getuserbyid",data:{openID:e},success:function(e){return t("log",e.data," at lib/restapi.js:96"),i.uuid=e.data.uuid,i.name=e.data.name,i.avatar=e.data.avater,i}}),s=(0,a.default)(n,2);s[0],s[1];return t("log","..."," at lib/restapi.js:103"),i},r.prototype.findGroupMembers=function(t){var e=[],i=s.find((function(e){return e.uuid==t}));return o.map((function(t){i.userList.find((function(e){return e==t.uuid}))&&e.push(t)})),e};var c=new r;e.default=c}).call(this,i("0de9")["log"])},b3d0:function(t,e,i){"use strict";(function(t){var n=i("4ea4");i("d3b7"),i("25f0"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("201f")),o={name:"contacts",data:function(){return{unreadTotal:0,conversations:[],action:{conversation:null,show:!1}}},onShow:function(){var e=uni.getStorageSync("currentUser");if(e){"disconnected"===this.goEasy.getConnectionStatus()&&(getApp().globalData.imService=new a.default(this.goEasy,this.GoEasy),getApp().globalData.imService.connect(e)),uni.showLoading();var i=this;this.goEasy.im.on(this.GoEasy.IM_EVENT.CONVERSATIONS_UPDATED,(function(t){i.renderConversations(t)})),this.goEasy.im.latestConversations({onSuccess:function(t){var e=t.content;i.renderConversations(e),uni.hideLoading()},onFailed:function(e){uni.hideLoading(),t("log","失败获取最新会话列表, code:"+e.code+" content:"+e.content," at pages/chatlist/chatlist.vue:84")}})}else uni.switchTab({url:"/pages/me/me"})},onTabItemTap:function(){var e=uni.getStorageSync("currentUser");if(e){"disconnected"===this.goEasy.getConnectionStatus()&&(getApp().globalData.imService=new a.default(this.goEasy,this.GoEasy),getApp().globalData.imService.connect(e)),uni.showLoading();var i=this;this.goEasy.im.on(this.GoEasy.IM_EVENT.CONVERSATIONS_UPDATED,(function(t){i.renderConversations(t)})),this.goEasy.im.latestConversations({onSuccess:function(e){var n=e.content;i.renderConversations(n),uni.hideLoading(),t("log",n," at pages/chatlist/chatlist.vue:113")},onFailed:function(e){uni.hideLoading(),t("log","失败获取最新会话列表, code:"+e.code+" content:"+e.content," at pages/chatlist/chatlist.vue:118")}})}else uni.switchTab({url:"/pages/me/me"})},methods:{topConversation:function(){uni.showLoading({title:"加载中...",mask:!0});var e=this.action.conversation,i=e.top?"取消置顶失败":"置顶失败";this.action.show=!1,e.type===this.GoEasy.IM_SCENE.PRIVATE?this.goEasy.im.topPrivateConversation({userId:e.userId,top:!e.top,onSuccess:function(){uni.hideLoading()},onFailed:function(e){uni.hideLoading(),uni.showToast({title:i,icon:"none"}),t("log",e," at pages/chatlist/chatlist.vue:144")}}):this.goEasy.im.topGroupConversation({groupId:e.groupId,top:!e.top,onSuccess:function(){uni.hideLoading()},onFailed:function(e){uni.hideLoading(),uni.showToast({title:i,icon:"none"}),t("log",e," at pages/chatlist/chatlist.vue:160")}})},removeConversation:function(){uni.showLoading({title:"加载中...",mask:!0});var e="删除失败",i=this.action.conversation;this.action.show=!1,i.type===this.GoEasy.IM_SCENE.PRIVATE?this.goEasy.im.removePrivateConversation({userId:i.userId,onSuccess:function(){uni.hideLoading()},onFailed:function(i){uni.hideLoading(),uni.showToast({title:e,icon:"none"}),t("log",i," at pages/chatlist/chatlist.vue:185")}}):this.goEasy.im.removeGroupConversation({groupId:i.groupId,onSuccess:function(){uni.hideLoading()},onFailed:function(i){uni.hideLoading(),uni.showToast({title:e,icon:"none"}),t("log",i," at pages/chatlist/chatlist.vue:200")}})},renderConversations:function(e){this.conversations=e.conversations||[];var i=e.unreadTotal;t("log",this.conversations," at pages/chatlist/chatlist.vue:208"),this.setUnreadAmount(i)},setUnreadAmount:function(t){this.unreadTotal=t,this.unreadTotal>0?uni.setTabBarBadge({index:0,text:this.unreadTotal.toString()}):uni.removeTabBarBadge({index:0})},navigateToChat:function(t){var e=t.type===this.GoEasy.IM_SCENE.PRIVATE?"/pages/privateChat/privateChat?to="+t.userId:"../chat/groupChat/groupChat?to="+t.groupId;uni.navigateTo({url:e})},showAction:function(t){this.action.conversation=t,this.action.show=!0}}};e.default=o}).call(this,i("0de9")["log"])},c179:function(t,e,i){"use strict";var n;i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return n}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-scroll-view",{staticClass:"conversations",attrs:{"scroll-y":"true"}},[0!=t.conversations.length?i("v-uni-view",t._l(t.conversations,(function(e,n){return i("v-uni-view",{key:n,staticClass:"scroll-item"},[i("v-uni-view",{staticClass:"item-head"},[i("v-uni-image",{staticClass:"head-icon",attrs:{src:e.data.avatar}}),e.unread?i("v-uni-view",{staticClass:"item-head_unread"},[t._v(t._s(e.unread))]):t._e()],1),i("v-uni-view",{staticClass:"scroll-item_info"},[i("v-uni-view",{staticClass:"item-info-top"},[i("v-uni-text",{staticClass:"item-info-top_name"},[t._v(t._s(e.data.name))]),i("v-uni-view",{staticClass:"item-info-top_time"},[t._v(t._s(t.formatDate(e.lastMessage.timestamp)))])],1),i("v-uni-view",{staticClass:"item-info-bottom"},[i("v-uni-view",{staticClass:"item-info-bottom-item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.navigateToChat(e)}}},["text"==e.lastMessage.type?i("v-uni-view",{staticClass:"item-info-top_content"},[t._v(t._s(e.lastMessage.payload.text))]):"video"==e.lastMessage.type?i("v-uni-view",{staticClass:"item-info-top_content"},[t._v("[视频消息]")]):"audio"==e.lastMessage.type?i("v-uni-view",{staticClass:"item-info-top_content"},[t._v("[语音消息]")]):"image"==e.lastMessage.type?i("v-uni-view",{staticClass:"item-info-top_content"},[t._v("[图片消息]")]):"file"==e.lastMessage.type?i("v-uni-view",{staticClass:"item-info-top_content"},[t._v("[文件消息]")]):"order"==e.lastMessage.type?i("v-uni-view",{staticClass:"item-info-top_content"},[t._v("[自定义消息:订单]")]):i("v-uni-view",{staticClass:"item-info-top_content"},[t._v("[[未识别内容]]")]),i("v-uni-view",{staticClass:"item-info-bottom_action",on:{click:function(i){i.stopPropagation(),arguments[0]=i=t.$handleEvent(i),t.showAction(e)}}})],1)],1)],1)],1)})),1):i("v-uni-view",{staticClass:"no-conversation"},[t._v("当前没有会话")]),t.action.show?i("v-uni-view",{staticClass:"action-container"},[i("v-uni-view",{staticClass:"layer",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.action.show=!1}}}),i("v-uni-view",{staticClass:"action-box"},[i("v-uni-view",{staticClass:"action-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.topConversation.apply(void 0,arguments)}}},[t._v(t._s(t.action.conversation.top?"取消置顶":"置顶聊天"))]),i("v-uni-view",{staticClass:"action-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.removeConversation.apply(void 0,arguments)}}},[t._v("删除聊天")])],1)],1):t._e()],1)},o=[]},d080:function(t,e,i){"use strict";i.r(e);var n=i("c179"),a=i("1dd9");for(var o in a)"default"!==o&&function(t){i.d(e,t,(function(){return a[t]}))}(o);i("90af");var s,r=i("f0c5"),c=Object(r["a"])(a["default"],n["b"],n["c"],!1,null,"76c381c5",null,!1,n["a"],s);e["default"]=c.exports}}]);